# GitLab Hooks y Flujo de Trabajo - Factura Movil POS Web

## 🔄 Flujo de Trabajo Recomendado

### **Branch Strategy**
- **`main`**: Branch de producción (protegido)
- **`develop`**: Branch de desarrollo (activo)
- **`feature/*`**: Branches para nuevas funcionalidades
- **`hotfix/*`**: Branches para correcciones urgentes

### **Git Hooks Recomendados**

#### **Pre-commit Hook (Local)**
```bash
#!/bin/sh
# .git/hooks/pre-commit

# Verificar que el código compile
npm run build

# Ejecutar tests básicos
npm run test:unit

# Verificar linting
npm run lint
```

#### **Pre-push Hook (Local)**
```bash
#!/bin/sh
# .git/hooks/pre-push

# Ejecutar tests completos
npm run test

# Verificar coverage mínimo
npm run test:coverage

# Verificar build de producción
npm run build
```

## 🚀 Pipeline de CI/CD

### **Stages del Pipeline**
1. **Test**: Instalación de dependencias y ejecución de tests
2. **Build**: Compilación de la aplicación
3. **Deploy**: Despliegue a staging/producción

### **Reglas de Deployment**
- **Staging**: Automático desde `develop`
- **Producción**: Manual desde `main` (requiere aprobación)

## 📋 Checklist de Merge Request

### **Antes de Crear MR**
- [ ] Tests pasando localmente
- [ ] Linting sin errores
- [ ] Build exitoso
- [ ] Coverage mínimo 80%
- [ ] Documentación actualizada

### **Durante la Revisión**
- [ ] Code review aprobado
- [ ] Tests de CI pasando
- [ ] Security scan limpio
- [ ] Performance aceptable

## 🔧 Configuración de GitLab

### **Variables de Entorno**
- `NODE_VERSION`: Versión de Node.js
- `AWS_ACCESS_KEY_ID`: Credenciales AWS
- `AWS_SECRET_ACCESS_KEY`: Credenciales AWS
- `STAGING_URL`: URL de staging
- `PRODUCTION_URL`: URL de producción

### **Protección de Branches**
- **`main`**: Solo merge requests aprobados
- **`develop`**: Merge requests con tests pasando

## 📊 Métricas de Calidad

### **Coverage Mínimo**
- **Unit Tests**: 80%
- **Integration Tests**: 70%
- **E2E Tests**: 60%

### **Performance**
- **Build Time**: < 5 minutos
- **Test Time**: < 3 minutos
- **Deploy Time**: < 10 minutos

## 🚨 Manejo de Errores

### **Fallback Strategy**
1. **Rollback automático** si tests fallan
2. **Notificación inmediata** en caso de error
3. **Logs detallados** para debugging

### **Escalación**
1. **Desarrollador**: Primera respuesta (15 min)
2. **Tech Lead**: Escalación (30 min)
3. **DevOps**: Emergencia (1 hora)
